<!DOCTYPE html>
<html>
  <head>
    <title>Exeger kurs</title>

<style>
      body {  background: #ffffff;margin: 0; padding-bottom: 3rem; font-family: -apple-system, BlinkMacSystemFont, "Comic sans", Comic, Helvetica, Arial, sans-serif; }


.formWrap {
  display: none;
  width: 29em;
  margin: 2em auto;
}

label {
  display: block;
  padding: 1em 0 0 0;
  color: #ffffff;
}

input {
  font-size: 2em;
  width: 100%;
  padding: 0.5em;
  border-radius: 0.25em;
  border: 1px solid #626262;
  background-color: #f2f2f2;
}

button {
  border: 0;
  background-color: orange;
  padding: 1rem 0;
  width: 32.666%;
  font-size: 1.5rem;
  color: #fff;
  margin: 2rem 0;
  border-radius: 0.25em;
  border: 1px solid #6f6f6f;
}
button:first-of-type {
  margin-left: 0;
}
button:hover {
  background-color: #6f6f6f;
}
button:active {
  box-shadow: inset 0 0 10px #a2a2a2;
  background-color: #6f6f6f;
}
button:focus {
  outline: 0;
}

.jumbotron {

   text-align: center;
     vertical-align: baseline;
  color: #ffffff;
    display: flex;
}
  .jumbotron .btn-primary {
    background: #845ac7;
    border-color: #845ac7; }
    .jumbotron .btn-primary:hover {
      background: #7646c1; }
  .jumbotron p {
    color: #d9ccee;
    max-width: 75%;
    margin: 1em auto 2em; }
    .date {
       text-align: center;
   font-size: 2rem;
  color: lightgrey;
  padding-top: 20px; 
    }
    .wrapper {
      display: none;
  max-width: 825px;
  margin: 5% auto;
  
}
.container {
 
  border-radius: 10px;
  padding: 20px;
  &.w-ls {
    max-width: 520px;
  }
  &.w-ml {
    max-width: 760px;
  }
  &.w-ms {
    max-width: 600px;
  }
  &.w-sm {
    max-width: 320px;
  }
}
.moneybags {

  display: flex;
  flex-flow: row wrap;
  margin: 0 -15px;
  align-items: stretch;
  justify-content: flex-start;
  //outline: 1px solid red;

  &__item {
    flex: 1 1 auto;
    position: relative;
    margin-bottom: 30px;
    padding: 0 15px;
    //outline: 1px solid black;

    &--total {
      display: flex;
      align-items: center;
      padding-top: 3%;
    }
    &:after {
      content: "+";
      font: bold 48px/100% Arial, Helvetica, sans-serif;
      color: #999;
      position: absolute;
      right: -13px;
      top: 40%;
    }
    &:nth-last-child(2):after {
      content: "";
    }
    &:last-child:after {
      content: "";
    }
    &:last-child:before {
      content: "=";
      font: bold 48px/100% Arial, Helvetica, sans-serif;
      color: #999;
      position: absolute;
      left: -15px;
      top: 40%;
    }
  }
  &__title {
    font: bold 24px/100% Helvetica, Arial, sans-serif;

    text-align: center;
    white-space: nowrap;
    margin-bottom: 16px;
    & .number {
      display: inline-block;
      background-color: #0172b7;
      border-radius: 50%;
      text-align: center;
      width: 1.375rem;
      height: 1.375rem;
      line-height: 1.5em;
      color: #fff;
      margin-right: 0.25rem;
      font-size: 2rem;
    }
    &--is-total {
      font: bold 30px/120% Helvetica, Arial, sans-serif;
      color: black;
      text-align: left;
      white-space: initial;
      padding-left: 30px;

    }
  }
  &__container {
    display: flex;
    flex-flow: row nowrap;
    justify-content: space-around;

  }
}

.moneybag {
display: flex;
justify-content: center;
align-items: flex-end;
padding-bottom: 20px;
   font: bold 20px/100% Helvetica, sans-serif;
  height: 120px;
  width: 100px;
  background: url(https://www.spv.se/SiteModules/Sjalvbetjaning/DigitalForsakringsInformation/Resources/Images/moneybag.svg)
    center / contain no-repeat;

  &--secondary {
    background-image: url(https://www.spv.se/SiteModules/Sjalvbetjaning/DigitalForsakringsInformation/Resources/Images/moneybag-secondary.svg);
  }

  &__wrapper {

    display: flex;
    flex-flow: column wrap;
    align-items: center;
  }

  &__sum {

    position: relative;
    top: 55%;
    color: white;
    text-align: center;
    & .value {
      font: 800 32px/100% Helvetica, sans-serif;
      display: block;
      margin-bottom: 0;
    }
    & .suffix {
      font: normal 30px/100% Helvetica, sans-serif;
      display: block;
      margin-bottom: 0;
    }
  }
}

.sub-heading--sm {

  font: bold 30px/100% Helvetica, sans-serif;
  color: #666;
  font-weight: 600;
  margin: 8px 8px 0;
  text-align: center;
}


  

@keyframes fadein {
    from { opacity: 0; }
    to   { opacity: 1; }
}

/* Firefox < 16 */
@-moz-keyframes fadein {
    from { opacity: 0; }
    to   { opacity: 1; }
}

/* Safari, Chrome and Opera > 12.1 */
@-webkit-keyframes fadein {
    from { opacity: 0; }
    to   { opacity: 1; }
}

/* Internet Explorer */
@-ms-keyframes fadein {
    from { opacity: 0; }
    to   { opacity: 1; }
}

/* Opera < 12.1 */
@-o-keyframes fadein {
    from { opacity: 0; }
    to   { opacity: 1; }
}

.grid-container {
  display: grid;
  grid-template-columns: auto auto auto;
  padding: 10px;
}
#box {font-size: 20rem;}
#ask {font-size: 5rem;  align-self: flex-end;}
#bid {font-size: 5rem;   align-self: flex-end;}
  .spinner {

   -webkit-animation: fadein 2s; /* Safari, Chrome and Opera > 12.1 */
       -moz-animation: fadein 2s; /* Firefox < 16 */
        -ms-animation: fadein 2s; /* Internet Explorer */
         -o-animation: fadein 2s; /* Opera < 12.1 */
            animation: fadein 2s;

  width: 100px;
  height: 100px;
  margin: 100px auto;
  background-color: #333;

  border-radius: 100%;  
  -webkit-animation: sk-scaleout 1.0s infinite ease-in-out;
  animation: sk-scaleout 1.0s infinite ease-in-out;
}

@-webkit-keyframes sk-scaleout {
  0% { -webkit-transform: scale(0) }
  100% {
    -webkit-transform: scale(1.0);
    opacity: 0;
  }
}

@keyframes sk-scaleout {
  0% { 
    -webkit-transform: scale(0);
    transform: scale(0);
  } 100% {
    -webkit-transform: scale(1.0);
    transform: scale(1.0);
    opacity: 0;
  }
    </style>
</head>
<body>


<div class="jumbotron text-center grid-container">




    <div class="grid-item" id="bid"></div>
  <div class="grid-item" id="box"></div>
  <div class="grid-item" id="ask"></div>  
</div>
  

   <div class="blazingStar spinner" id="spinner"></div>

 <div class="date">
  <span id="datum"></span>
   </div>
<div class="jumbotron text-center grid-container">

  <div class="wrapper" id="wrap">
  
<h2>Innehav</h2><br><h3><span class="number" id="number"></span> st aktier</h3>
       <div class="container w-sm">
    <div class="moneybags">

     
      <div class="moneybags__item">
       <h2 class="moneybags__title">Inköpsvärde</h2>
        <div class="moneybags__container"> 
          <div class="moneybag__wrapper">
            <div class="moneybag" id="valuebag"><span class="value" id="value"></span>
                <span class="suffix"> kr</span>
              <div class="moneybag__sum">
                 
              </div>
            </div>
          </div>
        </div>
      </div>

 <div class="moneybags__item">
   <h2 class="moneybags__title">Aktuellt värde</h2>
        <div class="moneybags__container">
          <div class="moneybag__wrapper">
            <div class="moneybag" id="aktvaluebag"><span class="value" id="aktvalue"></span>
                <span class="suffix"> kr</span>
              <div class="moneybag__sum">
             
              </div>
            </div>
          </div>
        </div>
      </div></div>

     
</div>
</div>

<div class="grid-item formWrap" id="form">


  <form id="localStorageTest" method="post" action="">
      <label>Hur många aktier?</label><br>
      <input type="text" name="q0" id="q0" class="q" value="" /><br>
      <label>GAV (räkna ut på <a href="http://www.aktiegav.se">aktiegav.se</a>)</label><br>
      <input type="text" name="q1" id="q1" class="q" value="" /><br>
    <button type="button" id="store">Spara</button>
    <button type="button" id="retrieve">Get</button>
    <button type="button" id="clear">Cleara</button>
  </form>
</div>




</div>




  
    <script src="/socket.io/socket.io.js"></script>
<script>



  var socket = io();



   var box = document.getElementById('box');

var senastekurs;
  var nykurs;



socket.on('kurs update', function(nykurs,bidstring,askstring,farg) {

 



  console.log(nykurs);
senastekurs=nykurs;
   
        document.body.style.backgroundColor = farg;
       

   

document.getElementById("spinner").style.display = "none";
box.innerHTML = nykurs;
bid.innerHTML = bidstring;
ask.innerHTML = askstring;

  });

socket.on('kurs update date', function(date) {

  retrieve();

datum.innerHTML = "Senaste uppdatering: " + date;
document.getElementById("form").style.display = "inline";
document.getElementById("wrap").style.display = "inline";

  });


  
</script>
<script>
  var stbt = document.getElementById("store");
stbt.addEventListener("click", storeIt, false);

var rtbt = document.getElementById("retrieve");
rtbt.addEventListener("click", retrieve, false);

var clbt = document.getElementById("clear");
clbt.addEventListener("click", clear, true);

var elv = document.getElementsByClassName('q');

function storeIt() {
  for (var i = 0; i < elv.length; i++) {
    var theVal = elv[i].value;
    if(theVal == '') { 
      alert("Fyll i values"); 
      return false; 
    }
    var storeName = elv[i].className + [i];
    localStorage.setItem(storeName, theVal);
  }
  alert("Du har sparat");
  
}

function retrieve() {
  if (!window.localStorage.length) { alert("Nothing stored!"); }
  for (var i = 0; i < localStorage.length; i++){
   // var obj = localStorage.getItem(localStorage.key(i));
    document.getElementById('q'+[i]).value = localStorage.getItem('q'+[i]);
    number.innerHTML = localStorage.getItem('q0');
    var integer = parseInt(localStorage.getItem('q0'), 10);
    var integer2 = parseInt(localStorage.getItem('q1'), 10);

    value.innerHTML = integer * integer2;
    aktvalue.innerHTML = integer * senastekurs;
    document.getElementById("aktvaluebag").style.height = senastekurs  + "px";
     document.getElementById("aktvaluebag").style.width = senastekurs  + "px";
         document.getElementById("valuebag").style.height = integer2 + "px";
     document.getElementById("valuebag").style.width = integer2 + "px";
    
  }
}
function clear() {
  if(!window.localStorage.length) {
    alert("Local storage is empty.");
  }
  localStorage.clear();
  var vlu = document.getElementsByClassName('q');
  for (var i = 0; i < vlu.length; i++){
    vlu[i].value = '';
  }
}
</script>

    <script src="client.js"></script>

</body>
</html>
